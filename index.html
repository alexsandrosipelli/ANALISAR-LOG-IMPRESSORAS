import pandas as pd

# Função para carregar os dados da planilha
def carregar_planilha(caminho):
    # Carregar os dados no DataFrame
    df = pd.read_excel(caminho)
    return df

# Função para calcular a variação entre os dias
def calcular_variacao(df):
    resultados = []
    
    # Iterar sobre os dados para comparar dia a dia
    for i in range(1, len(df)):
        # Obter os dados do dia anterior e do dia atual
        setor_anterior = df.iloc[i-1]
        setor_atual = df.iloc[i]
        
        # Verificar se o setor é o mesmo
        if setor_anterior['Setor'] == setor_atual['Setor']:
            # Calcular a variação percentual entre os dias (exemplo: variação de % de impressão)
            try:
                variação = abs(setor_atual['% Impressão'] - setor_anterior['% Impressão'])
                
                # Definir um critério de troca indevida (exemplo, variação > 20%)
                if variação > 20:
                    resultados.append({
                        'Data': setor_atual['Data'],
                        'Setor': setor_atual['Setor'],
                        'Variação': variação
                    })
            except KeyError:
                pass
    return resultados

# Função principal para execução
def verificar_trocas_indevias(caminho_arquivo):
    # Carregar os dados
    df = carregar_planilha(caminho_arquivo)
    
    # Calcular as variações entre os dias
    trocas_indevias = calcular_variacao(df)
    
    # Exibir as trocas indevidas
    if trocas_indevias:
        print("Trocas indevidas encontradas:")
        for troca in trocas_indevias:
            print(f"Data: {troca['Data']} | Setor: {troca['Setor']} | Variação: {troca['Variação']}%")
    else:
        print("Nenhuma troca indevida encontrada.")

# Caminho do arquivo (substitua pelo caminho correto)
caminho_arquivo = 'caminho_da_planilha.xlsx'

# Rodar a verificação
verificar_trocas_indevias(caminho_arquivo)
